#!/usr/bin/env python3.3
# -*- coding: utf-8 -*-
#
# Interface for CVE-Search
#  > Written for MongoDB
#
# Copyright (c) 2015 	Pieter-Jan Moreels
#
# Software is free software released under the "Original BSD license"

# Imports
import re

from lib.Config import Configuration as conf

# Variables
csdb = conf.getCSMongoConnection()

# Get
def getCVEInfo(cve):
  collection=csdb.cves
  info=collection.find_one({"id":cve})
  if info: info.pop("_id")
  return info

def getVulns(cpes, limit):
  collection=csdb.cves
  if not cpes: return []
  regexes = [re.compile(re.escape(x)) for x in cpes]
  return list(collection.find({'vulnerable_configuration': {"$in":regexes}}).sort("Modified", -1).limit(limit))
