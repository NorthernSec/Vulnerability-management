@cursor_wrapped
def getComponentNames(cur, team=None, system=None):
  if team and system:
    cur.execute("""SELECT name FROM Components WHERE id IN (
                     SELECT component_ID FROM Components_in_System_Group WHERE system_group_id IN (
                       SELECT id FROM System_Group WHERE team_id IN ( 
                         SELECT id FROM Teams WHERE name = %s ) AND name = %s;));""", (team,system))
  else:
    cur.execute("""SELECT name FROM Components;""")
  c=[x[0] for x in cur.fetchall()]
  return sorted(list(set(c)), key=lambda s: s.lower())


@cursor_wrapped
def getCPENames(cur, team=None):
  query="SELECT name FROM Components "
  if team:
    query+="""WHERE id IN(
                SELECT component_id FROM Components_in_System_Group WHERE system_group_id IN(
                  SELECT id from System_Groups WHERE team_id IN(
                    SELECT id from Teams where name = %s)))"""
  cur.execute(query, list(filter(None, [team])))
  cpes=[x[0] for x in cur.fetchall()]
  return list(set(itertools.chain(*cpes)))


@cursor_wrapped
def getStatusses(cur):
  cur.execute("""SELECT name FROM Ticket_Statusses;""")
  return [x[0] for x in cur.fetchall()]


@cursor_wrapped
def getTeamNames(cur):
  cur.execute("SELECT name FROM Teams;")
  return [x[0] for x in cur.fetchall()]
