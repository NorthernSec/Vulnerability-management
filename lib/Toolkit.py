#!/usr/bin/env python3.3
# -*- coding: utf-8 -*-
#
# Toolkit for functions between scripts
#
# Software is free software released under the "Modified BSD license"
#
# Copyright (c) 2014-2015 	Pieter-Jan Moreels


# Note of warning: CPEs like cpe:/o:microsoft:windows_8:-:-:x64 are given to us by Mitre
#  x64 will be parsed as Edition in this case, not Architecture
def toStringFormattedCPE(cpe,autofill=False):
  cpe=cpe.strip()
  if not cpe.startswith('cpe:2.3:'):
    if not cpe.startswith('cpe:/'): return False
    cpe=cpe.replace('cpe:/','cpe:2.3:')
    cpe=cpe.replace('::',':-:')
    cpe=cpe.replace('~-','~')
    cpe=cpe.replace('~',':-:')
    cpe=cpe.replace('::',':')
    cpe=cpe.strip(':-')
  if autofill:
    e=cpe.split(':')
    for x in range(0,13-len(e)):
      cpe+=':-'
  return cpe
