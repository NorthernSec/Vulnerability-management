#!/usr/bin/env python3.3
# -*- coding: utf-8 -*-
#
# Vulnerability Manager  SystemGroup object
#
# Copyright (c) 2014-2015 	Pieter-Jan Moreels
#
# Software is free software released under the "Original BSD license"

# Imports
import os
import sys
_runPath = os.path.dirname(os.path.realpath(__file__))
sys.path.append(os.path.join(_runPath, "../.."))

from flask.ext.login import UserMixin

from lib.database.Users import getUser, checkPass
from lib.exceptions import InvalidVariableTypes, UserNotFoundError

# Object
class User(UserMixin):
  def __init__(self, id):
    user=getUser(id)
    if not user: raise UserNotFoundError()
    self.id = id
    self.first_name=user["first_name"]
    self.last_name=user["last_name"]
    self.teams=user["teams"]

  @classmethod
  def get(self_class, id):
    try:
      return self_class(id)
    except UserNotFoundError:
      return None
      
  def verifyPass(self, pw):
    return True if checkPass(self.id, pw) else False
