<script>
  $(function() {
    var tNotes="{{ticket['notes']}}"
    function fixNotes(){
      $('#notes').empty();
      $('#notes').append(tNotes);
    }
    $('#edit-notes').bind('click', function() {
      $('#notes').empty();
      $('#notes').append("<textarea rows='4' cols='50' id='taNotes'>"+tNotes+"</textarea><br/>");
      $('#notes').append("<button id='updateNotes' type='button'>Update</button>");
      $('#notes').append("<button id='cancelNotes' type='button'>Cancel</button>");
      $('#cancelNotes').bind('click', function() { fixNotes(); })
      $('#updateNotes').bind('click', function() {
        var notes=$('#taNotes').val();
        $.getJSON('/_set_ticket_notes', {
          team:"{{team}}", cve:"{{ticket['cve']['id']}}", system:"{{system}}", notes:notes
        }, function(data) {
          if(data["status"] == true){
            tNotes=notes
            fixNotes();
          }else{
            alert("an error occured");
          }
        })
      })
    });
  })
</script>

<p>
  <b><span>{{ticket['cve']['id']}} - CVSS: {{ticket['cve']['cvss']}} - {{ticket['status']}}</span></b><br />
  <span>{{ticket['cve']['summary']}}</span>
</p>

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Notes <span id="edit-notes" class="glyphicon glyphicon-pencil" aria-hidden="true"></span></h3>
  </div>
  <div id="notes" class="panel-body">
    {{ticket["notes"]}}
  </div>
</div>

<div class="panel panel-info">
  <div class="panel-heading">
    <h3 class="panel-title">Actions</h3>
  </div>
  <div class="panel-body">
    <select>
      {% for s in statusses %}
        <option>{{s}}</option>
      {% endfor %}
    </select>
  </div>
</div>

